{{- if not .Values.database.existingSecret }}
---
apiVersion: v1
kind: Secret
metadata:
  name: postgres-credentials
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "cost-optimizer.labels" . | nindent 4 }}
type: Opaque
stringData:
  host: {{ .Values.database.host | quote }}
  port: {{ .Values.database.port | quote }}
  database: {{ .Values.database.name | quote }}
  username: {{ .Values.database.username | quote }}
  password: {{ .Values.database.password | default "changeme" | quote }}
{{- end }}

{{- if not .Values.redis.existingSecret }}
---
apiVersion: v1
kind: Secret
metadata:
  name: redis-credentials
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "cost-optimizer.labels" . | nindent 4 }}
type: Opaque
stringData:
  host: {{ .Values.redis.host | quote }}
  port: {{ .Values.redis.port | quote }}
  password: {{ .Values.redis.password | default "" | quote }}
{{- end }}

{{- if not .Values.storage.existingSecret }}
---
apiVersion: v1
kind: Secret
metadata:
  name: storage-credentials
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "cost-optimizer.labels" . | nindent 4 }}
type: Opaque
stringData:
  endpoint: {{ .Values.storage.endpoint | quote }}
  bucket: {{ .Values.storage.bucket | quote }}
  access_key: {{ .Values.storage.accessKey | default "changeme" | quote }}
  secret_key: {{ .Values.storage.secretKey | default "changeme" | quote }}
{{- end }}
